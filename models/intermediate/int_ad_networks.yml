version: 2

models:

  # ============================================================
  # AD NETWORK 2
  # ============================================================

  - name: int_ad_network_2_enriched
    description: >
      Enriched version of Ad Network 2 data.
      Adds derived country_code extracted from campaign_name.
    columns:
      - name: campaign_id
        tests: [not_null]
      - name: campaign_name
      - name: report_date
        tests: [not_null]
      - name: country_code
      - name: spend
      - name: impressions
      - name: clicks

  - name: int_ad_network_2_geo_joined
    description: >
      Joins Ad Network 2 enriched data with geo dictionary to map
      country_code → country_name and country_id.
    columns:
      - name: country_id
        description: "Foreign key from geo dimension."
        tests:
          # ensures every country_id exists in geo dimension
          - relationships:
              arguments:
                to: ref('int_geo_dim_extension')
                field: location_id
      - name: country_code
        tests:
          - not_null

 
  # ============================================================
  # AD NETWORK 1 – COUNTRY LEVEL
  # ============================================================
  - name: int_ad_network_1_country_enriched
    description: >
      Enriched Ad Network 1 country-level report combining performance,
      campaign metadata (latest update < report_date),
      and geo info from int_geo_dim_extension.
    columns:
      - name: report_date
        description: "Date of the country-level performance report."
        tests:
          - not_null
      - name: campaign_id
        description: "Unique campaign identifier."
        tests:
          - not_null
      - name: country_id
        description: "Geo dictionary ID for the country."
        tests:
          - not_null
      - name: country_name
        description: "Full name of the country."
      - name: country_code
        description: "ISO Alpha-2 country code."
      - name: spend
        description: "Ad spend (USD)."
      - name: impressions
        description: "Number of ad impressions."
      - name: clicks
        description: "Number of ad clicks."

  # ============================================================
  # AD NETWORK 1 – STATE LEVEL
  # ============================================================
  - name: int_ad_network_1_state_enriched
    description: >
      Enriched Ad Network 1 state-level report combining detailed data,
      campaign metadata (latest update < report_date),
      and hierarchical geo information.
    columns:
      - name: report_date
        description: "Date of the state-level performance report."
        tests:
          - not_null
      - name: campaign_id
        description: "Unique campaign identifier."
        tests:
          - not_null
      - name: state_id
        description: "Geo dictionary ID for the state."
        tests:
          - not_null
      - name: country_id
        description: "Geo dictionary ID for the associated country."
        tests:
          - not_null
      - name: spend
        description: "Ad spend (USD)."
      - name: impressions
        description: "Number of ad impressions."
      - name: clicks
        description: "Number of ad clicks."
