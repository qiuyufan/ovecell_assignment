version: 2

models:
  - name: mkt_ad_performance_mart
    description: "Unified ad performance mart for both Ad Networks."
    columns:
      - name: geo_level
        description: "Granularity level of the record ('country' or 'state')."
        tests:
          - accepted_values:
              values: ['country', 'state']

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - ad_network
            - report_date
            - campaign_id
            - country_name
            - coalesce(state_name, 'None')
            - geo_level
